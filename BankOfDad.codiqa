{"v":"b1","css":"","js":"$(function(){\n    \n  // init database refs\n    var fireRoot = new Firebase('https://bankofdad.firebaseio.com/');\n    var fireCurrent = fireRoot.child('accounts/jax');\n\n  // config some html settings \n    $('#amount').attr('pattern','\\d+(\\.\\d*)?');\n    $('#amount').attr('step','0.25');\n  \n  // load data into UI (autodates on change)\n    var fnUpdateBalanceText = function(snapshot){\n        $('#balance_text').text( '$'+(snapshot.val()||0).toFixed(2) );\n      }\n    function unwatchBalance(){\n      fireCurrent.child('balance').off('value', fnUpdateBalanceText );\n    }\n    function watchBalance(){\n      fireCurrent.child('balance').on('value', fnUpdateBalanceText )\n    }\n    watchBalance()\n\n  // setup submit button enabling/disabling\n    var fnInputChange = function(e){\n      if( $('#for').val().length + $('#amount').val().length == 0 ) {\n        $('#enter').button('disable');\n      } else {\n        $('#enter').button('enable');\n      }\n      $('#enter').button('refresh');\n\n    }  \n    fnInputChange();\n\n  // EVENT HANDLERS\n\n  $('#for').on('change', fnInputChange)\n\n  $('#amount').on('change', fnInputChange)\n\n  $('#enter_form').on('submit',function(e){\n    // write ledger entry\n      fireCurrent.child('txs').push({\n          'date': (new Date()).toString().split(' GMT')[0], // friendly date text before the timezone\n          'for': $('#for').val(),\n          'amt': $('#amount').val()\n      });\n    // modify balance\n      var balance = Number(($('#balance_text').text()||'0').replace(/[^0-9-\\.]+/g,'')); // string to #\n      var delta = Number(($('#amount').val()||'0').replace(/[^0-9-\\.]+/g,'')); // string to #\n      balance += delta;\n      fireCurrent.child('balance').set(balance);\n    // reset ui\n      $('#choose_action').val('choose').change();  \n    // nix normal submit behaviour\n      e.preventDefault();\n  })\n\n  $('#choose_action').on('change', function(e){\n\n      if(this.value == 'choose') {\n\n        $('#for').val('');\n        $('#amount').val('');\n\n      } else {\n\n        $('#for').val(this.value);\n\n        if (this.value == 'hurt'){\n          $('#amount').val('-1.00');\n        } else if (this.value == 'antagonize'){\n          $('#amount').val('-0.25');\n        } else if (this.value == 'ignore'){\n          $('#amount').val('-0.25');\n        } else if (this.value == 'shout'){\n          $('#amount').val('-0.25');\n        } else if (this.value == 'allowance'){\n          $('#amount').val('3.00');\n        }\n      }\n\n      fnInputChange();\n      \n  })\n  \n  \n  $('#account_toggle a').on('click', function(e){\n    unwatchBalance(); // unwatch old db balance for updates\n    if (this.text.trim() == 'Jax') {\n        $('#balance_text').css('color', 'darkgreen');\n        fireCurrent = fireRoot.child('accounts/jax');\n    }\n    if (this.text.trim() == 'Remi') {\n        $('#balance_text').css('color', 'hotpink');\n        fireCurrent = fireRoot.child('accounts/remi');\n    }\n    watchBalance(); // watch new db balance for updates\n  })\n  \n})\n  ","saved":1448209504157,"doc":{"id":null,"type":"app","children":[{"id":"home","type":"page","children":[{"id":"pageheader2","type":"pageheader","children":[{"id":"heading4","type":"heading","children":[],"properties":{"attributes":"","text":"Bank of Dad","size":1,"extraClasses":"ui-title"}}],"properties":{"attributes":"","theme":"b","isFixed":"fixed","noHeading":"false"}},{"id":"pagecontent1","type":"pagecontent","children":[{"id":"form1","type":"form","children":[{"id":"text3","type":"text","children":[],"properties":{"elementId":"balance","attributes":"","text":"<p style=\"text-align: center;\" data-mce-style=\"text-align: center;\"><span id=\"balance_text\" style=\"font-size: 80px; font-family: 'arial black', 'avant garde'; color: darkgreen;\" data-mce-style=\"font-size: 80px; font-family: 'arial black', 'avant garde'; color: darkgreen;\">$0.00</span></p>"}},{"id":"textinput1","type":"textinput","children":[],"properties":{"elementId":"for","attributes":"","isMini":"false","title":"","placeholder":"Describe the transaction","text":"","name":"","type":"text"}},{"id":"textinput2","type":"textinput","children":[],"properties":{"elementId":"amount","attributes":"","isMini":"false","title":"","placeholder":"Enter the amount","text":"","name":"","type":"text"}},{"id":"selectmenu2","type":"selectmenu","children":[],"properties":{"elementId":"choose_action","attributes":"","isMini":"false","name":"","title":"","isNative":"false","theme":"","items":[{"text":"Or choose one","value":"choose","theme":""},{"text":"Allowance","value":"allowance","theme":""},{"text":"Ignore","value":"ignore","theme":""},{"text":"Shout","value":"shout","theme":""},{"text":"Antagonize","value":"antagonize","theme":""},{"text":"Hurt","value":"hurt","theme":""}]}},{"id":"submitbutton1","type":"submitbutton","children":[],"properties":{"elementId":"enter","elementClass":"","attributes":"","isMini":"false","text":"Save","isInline":"false","icon":{"icon":"","align":"right"},"theme":""}},{"id":"hiddeninput1","type":"hiddeninput","children":[],"properties":{"attributes":"","name":"account","value":""}},{"id":"pagefooter1","type":"pagefooter","children":[{"id":"navbar6","type":"navbar","children":[],"properties":{"elementId":"account_toggle","attributes":"","iconPos":{"align":"top"},"items":[{"text":"Jax","icon":"bars","url":"home","theme":"","transition":"none"},{"text":"Remi","icon":"bars","url":"home","theme":"","transition":"fade"}]}}],"properties":{"attributes":"","theme":"b","isFixed":"fixed","noHeading":"false"}}],"properties":{"elementId":"enter_form","attributes":"","enableFileUploads":"","url":"","action":"GET","ajax":"false"}}],"properties":{"attributes":""}}],"properties":{"elementId":"home","attributes":"","title":"Home","isDefault":"true","theme":"a","bgImage":"","bgImageRepeat":"no-repeat","contentPadding":{"value":"2","units":"%","_property_title":"Content Padding","_wid":"view1434"}}}],"properties":{"attributes":"","title":"","headScripts":[],"scripts":["https://cdn.firebase.com/js/client/2.3.2/firebase.js"],"stylesheets":[],"initialSize":"320x568","activeJQMTheme":"","framework":"jqm","frameworkVersion":"1.4.0"}}}